========================================================================
             AI FOREX ORCHESTRATOR 2026 - MANUAL (РУКОВОДСТВО)
========================================================================

1. ОБЩЕЕ ОПИСАНИЕ
Система представляет собой мульти-агентную платформу для алготрейдинга 
на базе LSTM-сетей. Каждый агент (Symbol_TF) работает автономно, имея 
собственную нейросеть, базу данных и систему риск-контроля.

2. ТРЕБОВАНИЯ (2026)
- Python 3.10+
- MetaTrader 5 Terminal (установлен и авторизован)
- Библиотеки: tensorflow, pandas, pandas_ta, streamlit, plotly, scikit-learn

3. ПЕРВЫЙ ЗАПУСК
   А. Настройте список пар в config.py (SYMBOLS_LIST и ACTIVE_TIMEFRAMES).
   Б. Запустите терминал MetaTrader 5.
   В. Запустите торговое ядро:
      > python main.py --train
      (Флаг --train обязателен при первом запуске для первичного обучения).
   Г. Запустите панель управления:
      > streamlit run hmi.py

4. РЕЖИМЫ РАБОТЫ
- REAL-TRADE: Работа с реальными котировками из MT5. Сделки помечаются
  комментарием (напр. 'EURUSD_H1') для корректной фильтрации в статистике.
- SIMULATION: Используется база данных simulation_main.db. Позволяет 
  протестировать интерфейс без подключения к рынку. Переключается в HMI 
  при запуске или через app_config.json.

5. УПРАВЛЕНИЕ АГЕНТАМИ (HMI MAIN)
- Кнопка "EDU": Принудительно отправляет агента на полное переобучение.
- Кнопка "ADAPT": Запускает микро-корректировку весов (Fine-tuning).
- Чекбокс "Global Trading Allowed": Главный предохранитель всей системы.

6. СИСТЕМА КОНТРОЛЯ (RE-EDUCATION & QUARANTINE)
Если ошибка прогноза (MSE) превышает норму в 1.8 раза (ERR_THRESHOLD):
- Модель автоматически уходит на переобучение.
- После обучения агент переходит в режим "Карантин" (4 бара).
- Торговля возобновится только после подтверждения точности.

7. СОГЛАСОВАННОСТЬ ДАННЫХ
- Все признаки (7 шт: OHLCV + RSI + ATR) рассчитываются идентично 
  в Education.py и DataFactory.py.
- Индикаторы берутся из настроек TF_SETTINGS в config.py.
- Для корректной статистики StatManager фильтрует историю MT5 по 
  комментарию, который должен совпадать с ID агента (Symbol_TF).

8. БЕЗОПАСНОСТЬ
- Команды передаются через атомарную запись в hmi_commands.json.
- Логирование ведется в режиме SQLite WAL (Write-Ahead Logging), 
  что позволяет одновременно записывать логи от 20+ ботов и 
  просматривать их в SOE Viewer без блокировок базы данных.

9. ЗАВЕРШЕНИЕ РАБОТЫ
При закрытии main.py (Ctrl+C) срабатывает ShutdownManager. 
Если в app_config.json установлен флаг "close_on_exit": true, 
все позиции, открытые ботом, будут немедленно закрыты по рынку.
========================================================================
